<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/appbibliofilia/ui/BookCRUDScreen/BooksViewModelTest.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/appbibliofilia/ui/BookCRUDScreen/BooksViewModelTest.kt" />
              <option name="originalContent" value="package com.example.appbibliofilia.ui.BookCRUDScreen&#10;&#10;import org.junit.Assert.*&#10;import org.junit.Test&#10;&#10;class BooksViewModelTest {&#10;&#10;    @Test&#10;    fun `addBook adds a book with incremental id and inserts at beginning`() {&#10;        val vm = BooksViewModel()&#10;&#10;        vm.addBook(&quot;Libro 1&quot;, &quot;Autor 1&quot;, BookFormat.FISICO)&#10;        vm.addBook(&quot;Libro 2&quot;, &quot;Autor 2&quot;, BookFormat.DIGITAL)&#10;&#10;        val books = vm.books&#10;        assertEquals(2, books.size)&#10;&#10;        // El último agregado va primero&#10;        assertEquals(&quot;Libro 2&quot;, books[0].name)&#10;        assertEquals(&quot;Libro 1&quot;, books[1].name)&#10;&#10;        // IDs autoincrementales locales&#10;        assertEquals(2L, books[0].id)&#10;        assertEquals(1L, books[1].id)&#10;    }&#10;&#10;    @Test&#10;    fun `updateBook changes fields but keeps same id`() {&#10;        val vm = BooksViewModel()&#10;        vm.addBook(&quot;Libro 1&quot;, &quot;Autor 1&quot;, BookFormat.FISICO)&#10;        val original = vm.books.first()&#10;&#10;        vm.updateBook(&#10;            id = original.id,&#10;            name = &quot;Nuevo nombre&quot;,&#10;            author = &quot;Nuevo autor&quot;,&#10;            format = BookFormat.DIGITAL&#10;        )&#10;&#10;        val updated = vm.books.first()&#10;        assertEquals(original.id, updated.id)&#10;        assertEquals(&quot;Nuevo nombre&quot;, updated.name)&#10;        assertEquals(&quot;Nuevo autor&quot;, updated.author)&#10;        assertEquals(BookFormat.DIGITAL, updated.format)&#10;    }&#10;&#10;    @Test&#10;    fun `deleteBook removes book and clears editingId if it was being edited`() {&#10;        val vm = BooksViewModel()&#10;        vm.addBook(&quot;Libro 1&quot;, &quot;Autor 1&quot;, BookFormat.FISICO)&#10;        vm.addBook(&quot;Libro 2&quot;, &quot;Autor 2&quot;, BookFormat.DIGITAL)&#10;&#10;        val toDeleteId = vm.books.first().id&#10;        vm.startEditing(toDeleteId)&#10;        assertEquals(toDeleteId, vm.editingId)&#10;&#10;        vm.deleteBook(toDeleteId)&#10;&#10;        assertEquals(1, vm.books.size)&#10;        assertNull(vm.editingId)&#10;        assertTrue(vm.books.none { it.id == toDeleteId })&#10;    }&#10;&#10;    @Test&#10;    fun `getBook returns book when id exists and null otherwise`() {&#10;        val vm = BooksViewModel()&#10;        vm.addBook(&quot;Libro 1&quot;, &quot;Autor 1&quot;, BookFormat.FISICO)&#10;        val id = vm.books.first().id&#10;&#10;        val found = vm.getBook(id)&#10;        assertNotNull(found)&#10;        assertEquals(&quot;Libro 1&quot;, found?.name)&#10;&#10;        val missing = vm.getBook(999L)&#10;        assertNull(missing)&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.appbibliofilia.ui.BookCRUDScreen&#10;&#10;// Este archivo previamente contenía pruebas unitarias y fue movido a:&#10;// app/src/test/kotlin/com/example/appbibliofilia/ui/BookCRUDScreen/BooksViewModelTest.kt&#10;// Mantener un placeholder aquí para evitar que el test se incluya en la compilación de producción." />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/appbibliofilia/ui/home/HomeViewModelTest.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/appbibliofilia/ui/home/HomeViewModelTest.kt" />
              <option name="originalContent" value="package com.example.appbibliofilia.ui.home&#10;&#10;import com.example.appbibliofilia.data.model.UserRecord&#10;import org.junit.Assert.*&#10;import org.junit.Test&#10;&#10;class HomeViewModelTest {&#10;&#10;    @Test&#10;    fun `handleLogin with empty fields returns null and sets errorMessage`() {&#10;        val vm = HomeViewModel()&#10;&#10;        // username y password iniciales son &quot;&quot; por defecto&#10;        val user = vm.handleLogin { _, _ -&gt;&#10;            // no debería llamarse si los campos están vacíos&#10;            fail(&quot;El callback de login no debería ejecutarse cuando faltan campos&quot;)&#10;            null&#10;        }&#10;&#10;        assertNull(user)&#10;        assertEquals(&quot;Por favor completa todos los campos&quot;, vm.errorMessage)&#10;        assertFalse(vm.isSubmitting)&#10;    }&#10;&#10;    @Test&#10;    fun `handleLogin with invalid credentials sets incorrect user error`() {&#10;        val vm = HomeViewModel()&#10;        vm.updateUsername(&quot;jackie&quot;)&#10;        vm.updatePassword(&quot;wrong&quot;)&#10;&#10;        val user = vm.handleLogin { _, _ -&gt; null }&#10;&#10;        assertNull(user)&#10;        assertEquals(&quot;Usuario o contraseña incorrectos&quot;, vm.errorMessage)&#10;        assertFalse(vm.isSubmitting)&#10;    }&#10;&#10;    @Test&#10;    fun `handleLogin with valid user clears errorMessage and returns user`() {&#10;        val vm = HomeViewModel()&#10;        vm.updateUsername(&quot;jackie&quot;)&#10;        vm.updatePassword(&quot;secret&quot;)&#10;&#10;        val expected = UserRecord(&#10;            username = &quot;jackie&quot;,&#10;            password = &quot;secret&quot;,&#10;            name = &quot;Jackie&quot;,&#10;            email = &quot;j@example.com&quot;&#10;        )&#10;&#10;        var callbackCalled = false&#10;&#10;        val result = vm.handleLogin { username, password -&gt;&#10;            callbackCalled = true&#10;            assertEquals(&quot;jackie&quot;, username)&#10;            assertEquals(&quot;secret&quot;, password)&#10;            expected&#10;        }&#10;&#10;        assertTrue(callbackCalled)&#10;        assertEquals(expected, result)&#10;        assertEquals(&quot;&quot;, vm.errorMessage)&#10;        assertFalse(vm.isSubmitting)&#10;    }&#10;&#10;    @Test&#10;    fun `updateUsername and updatePassword update state and clear previous error`() {&#10;        val vm = HomeViewModel()&#10;&#10;        // Forzamos un error previo&#10;        val user = vm.handleLogin { _, _ -&gt; null }&#10;        assertNull(user)&#10;        assertEquals(&quot;Por favor completa todos los campos&quot;, vm.errorMessage)&#10;&#10;        vm.updateUsername(&quot;nuevoUser&quot;)&#10;        vm.updatePassword(&quot;nuevaPass&quot;)&#10;        vm.clearError()&#10;&#10;        assertEquals(&quot;nuevoUser&quot;, vm.username)&#10;        assertEquals(&quot;nuevaPass&quot;, vm.password)&#10;        assertEquals(&quot;&quot;, vm.errorMessage)&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.appbibliofilia.ui.home&#10;&#10;// Este archivo anteriormente contenía pruebas unitarias y fue movido a:&#10;// app/src/test/kotlin/com/example/appbibliofilia/ui/home/HomeViewModelTest.kt&#10;// Mantener un archivo placeholder aquí para evitar errores en IDEs que lo referencien." />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/appbibliofilia/ui/register/RegisterViewModelTest.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/appbibliofilia/ui/register/RegisterViewModelTest.kt" />
              <option name="originalContent" value="package com.example.appbibliofilia.ui.register&#10;&#10;import org.junit.Assert.*&#10;import org.junit.Test&#10;import java.util.Calendar&#10;&#10;class RegisterViewModelTest {&#10;&#10;    private val vm = RegisterViewModel()&#10;&#10;    @Test&#10;    fun `validateName blank returns error`() {&#10;        val result = vm.validateName(&quot;&quot;)&#10;        assertEquals(&quot;El nombre no puede estar vacío&quot;, result)&#10;    }&#10;&#10;    @Test&#10;    fun `validateName non blank returns empty error`() {&#10;        val result = vm.validateName(&quot;Jackie&quot;)&#10;        assertEquals(&quot;&quot;, result)&#10;    }&#10;&#10;    @Test&#10;    fun `validateEmail blank returns error`() {&#10;        val result = vm.validateEmail(&quot;&quot;)&#10;        assertEquals(&quot;Correo inválido&quot;, result)&#10;    }&#10;&#10;    @Test&#10;    fun `validateEmail without at returns error`() {&#10;        val result = vm.validateEmail(&quot;correo-invalido&quot;)&#10;        assertEquals(&quot;Correo inválido&quot;, result)&#10;    }&#10;&#10;    @Test&#10;    fun `validateEmail valid returns empty error`() {&#10;        val result = vm.validateEmail(&quot;test@example.com&quot;)&#10;        assertEquals(&quot;&quot;, result)&#10;    }&#10;&#10;    @Test&#10;    fun `validatePassword shorter than 6 returns error`() {&#10;        val result = vm.validatePassword(&quot;12345&quot;)&#10;        assertEquals(&quot;La contraseña debe tener al menos 6 caracteres&quot;, result)&#10;    }&#10;&#10;    @Test&#10;    fun `validatePassword length 6 or more returns empty error`() {&#10;        val result = vm.validatePassword(&quot;123456&quot;)&#10;        assertEquals(&quot;&quot;, result)&#10;    }&#10;&#10;    @Test&#10;    fun `validateBirthDateComponents future date returns error`() {&#10;        val today = Calendar.getInstance()&#10;        val futureYear = today.get(Calendar.YEAR) + 1&#10;&#10;        val error = vm.validateBirthDateComponents(&#10;            futureYear,&#10;            today.get(Calendar.MONTH),&#10;            today.get(Calendar.DAY_OF_MONTH)&#10;        )&#10;&#10;        assertEquals(&quot;No puedes seleccionar una fecha futura&quot;, error)&#10;    }&#10;&#10;    @Test&#10;    fun `validateBirthDateComponents age less than 10 returns error`() {&#10;        val today = Calendar.getInstance()&#10;        val yearLessThan10 = today.get(Calendar.YEAR) - 5&#10;&#10;        val error = vm.validateBirthDateComponents(&#10;            yearLessThan10,&#10;            today.get(Calendar.MONTH),&#10;            today.get(Calendar.DAY_OF_MONTH)&#10;        )&#10;&#10;        assertEquals(&quot;Debes tener al menos 10 años&quot;, error)&#10;    }&#10;&#10;    @Test&#10;    fun `validateBirthDateComponents age greater than 100 returns error`() {&#10;        val today = Calendar.getInstance()&#10;        val yearMoreThan100 = today.get(Calendar.YEAR) - 101&#10;&#10;        val error = vm.validateBirthDateComponents(&#10;            yearMoreThan100,&#10;            today.get(Calendar.MONTH),&#10;            today.get(Calendar.DAY_OF_MONTH)&#10;        )&#10;&#10;        assertEquals(&quot;Fecha no válida (mayor de 100 años)&quot;, error)&#10;    }&#10;&#10;    @Test&#10;    fun `validateBirthDateComponents valid age between 10 and 100 returns empty error`() {&#10;        val today = Calendar.getInstance()&#10;        val validYear = today.get(Calendar.YEAR) - 20&#10;&#10;        val error = vm.validateBirthDateComponents(&#10;            validYear,&#10;            today.get(Calendar.MONTH),&#10;            today.get(Calendar.DAY_OF_MONTH)&#10;        )&#10;&#10;        assertEquals(&quot;&quot;, error)&#10;    }&#10;&#10;    @Test&#10;    fun `validateBirthDateString blank returns error`() {&#10;        val error = vm.validateBirthDateString(&quot;&quot;)&#10;        assertEquals(&quot;Selecciona una fecha válida&quot;, error)&#10;    }&#10;&#10;    @Test&#10;    fun `validateBirthDateString non blank returns empty error`() {&#10;        val error = vm.validateBirthDateString(&quot;01/01/2000&quot;)&#10;        assertEquals(&quot;&quot;, error)&#10;    }&#10;&#10;    @Test&#10;    fun `validateAll with invalid data returns all errors and isValid false`() {&#10;        val result = vm.validateAll(&#10;            name = &quot;&quot;,&#10;            email = &quot;correo&quot;,&#10;            password = &quot;123&quot;,&#10;            birthDate = &quot;&quot;&#10;        )&#10;&#10;        assertEquals(&quot;El nombre no puede estar vacío&quot;, result.nameError)&#10;        assertEquals(&quot;Correo inválido&quot;, result.emailError)&#10;        assertEquals(&quot;La contraseña debe tener al menos 6 caracteres&quot;, result.passwordError)&#10;        assertEquals(&quot;Selecciona una fecha válida&quot;, result.birthDateError)&#10;        assertFalse(result.isValid)&#10;    }&#10;&#10;    @Test&#10;    fun `validateAll with valid data returns no errors and isValid true`() {&#10;        val today = Calendar.getInstance()&#10;        val validYear = today.get(Calendar.YEAR) - 20&#10;        val birthDate = vm.formatDate(&#10;            today.get(Calendar.DAY_OF_MONTH),&#10;            today.get(Calendar.MONTH),&#10;            validYear&#10;        )&#10;&#10;        val result = vm.validateAll(&#10;            name = &quot;Jackie&quot;,&#10;            email = &quot;jackie@example.com&quot;,&#10;            password = &quot;123456&quot;,&#10;            birthDate = birthDate&#10;        )&#10;&#10;        assertEquals(&quot;&quot;, result.nameError)&#10;        assertEquals(&quot;&quot;, result.emailError)&#10;        assertEquals(&quot;&quot;, result.passwordError)&#10;        assertEquals(&quot;&quot;, result.birthDateError)&#10;        assertTrue(result.isValid)&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.appbibliofilia.ui.register&#10;&#10;// Este archivo anteriormente contenía pruebas unitarias y fue movido a:&#10;// app/src/test/kotlin/com/example/appbibliofilia/ui/register/RegisterViewModelTest.kt&#10;// Mantener un archivo placeholder aquí para evitar errores en IDEs que lo referencien." />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>